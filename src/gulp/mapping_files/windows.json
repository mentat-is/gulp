{
    "metadata": {
        "plugin": [
            "win_evtx.py"
        ]
    },
    "sigma_mappings": {
        "application": {
            "service_field": "winlog.channel",
            "service_values": [
                "Application"
            ]
        },
        "application-experience": {
            "service_field": "winlog.channel",
            "service_values": [
                "Microsoft-Windows-Application-Experience/Program-Telemetry",
                "Microsoft-Windows-Application-Experience/Program-Compatibility-Assistant"
            ]
        },
        "applocker": {
            "service_field": "winlog.channel",
            "service_values": [
                "Microsoft-Windows-AppLocker/MSI and Script",
                "Microsoft-Windows-AppLocker/EXE and DLL",
                "Microsoft-Windows-AppLocker/Packaged app-Deployment",
                "Microsoft-Windows-AppLocker/Packaged app-Execution"
            ]
        },
        "appmodel-runtime": {
            "service_field": "winlog.channel",
            "service_values": [
                "Microsoft-Windows-AppModel-Runtime/Admin"
            ]
        },
        "appxdeployment-server": {
            "service_field": "winlog.channel",
            "service_values": [
                "Microsoft-Windows-AppXDeployment-Server/Operational"
            ]
        },
        "appxpackaging-om": {
            "service_field": "winlog.channel",
            "service_values": [
                "Microsoft-Windows-AppXPackaging/Operational"
            ]
        },
        "bitlocker": {
            "service_field": "winlog.channel",
            "service_values": [
                "Microsoft-Windows-BitLocker/Bitlocker Management"
            ]
        },
        "bits-client": {
            "service_field": "winlog.channel",
            "service_values": [
                "Microsoft-Windows-Bits-Client/Operational"
            ]
        },
        "capi2": {
            "service_field": "winlog.channel",
            "service_values": [
                "Microsoft-Windows-CAPI2/Operational"
            ]
        },
        "certificateserviceclient-lifecycle-system": {
            "service_field": "winlog.channel",
            "service_values": [
                "Microsoft-Windows-CertificateServicesClient-Lifecycle-System/Operational"
            ]
        },
        "codeintegrity-operational": {
            "service_field": "winlog.channel",
            "service_values": [
                "Microsoft-Windows-CodeIntegrity/Operational"
            ]
        },
        "dhcp-client": {
            "service_field": "winlog.channel",
            "service_values": [
                "Microsoft-Windows-DHCP-Server/Operational"
            ]
        },
        "diagnosis-scripted": {
            "service_field": "winlog.channel",
            "service_values": [
                "Microsoft-Windows-Diagnosis-Scripted/Operational"
            ]
        },
        "dns-client": {
            "service_field": "winlog.channel",
            "service_values": [
                "Microsoft-Windows-DNS Client Events/Operational"
            ]
        },
        "dns-server": {
            "service_field": "winlog.channel",
            "service_values": [
                "DNS Server"
            ]
        },
        "dns-server-analytic": {
            "service_field": "winlog.channel",
            "service_values": [
                "Microsoft-Windows-DNS-Server/Analytical"
            ]
        },
        "dns-server-audit": {
            "service_field": "winlog.channel",
            "service_values": [
                "Microsoft-Windows-DNS-Server/Audit"
            ]
        },
        "driver-framework": {
            "service_field": "winlog.channel",
            "service_values": [
                "Microsoft-Windows-DriverFrameworks-UserMode/Operational"
            ]
        },
        "firewall-as": {
            "service_field": "winlog.channel",
            "service_values": [
                "Microsoft-Windows-Windows Firewall/Firewalll With Advanced Security/Firewall"
            ]
        },
        "hyper-v-worker": {
            "service_field": "winlog.channel",
            "service_values": [
                "Microsoft-Windows-Hyper-V-Worker"
            ]
        },
        "iis-configuration": {
            "service_field": "winlog.channel",
            "service_values": [
                "Microsoft-Windows-IIS-Configuration/Operational"
            ]
        },
        "kernel-event-tracing": {
            "service_field": "winlog.channel",
            "service_values": [
                "Microsoft-Windows-Kernel-EventTracing"
            ]
        },
        "kernel-shimengine": {
            "service_field": "winlog.channel",
            "service_values": [
                "Microsoft-Windows-Kernel-ShimEngine/Operational",
                "WinEventLog:Microsoft-Windows-Kernel-ShimEngine/Diagnostic"
            ]
        },
        "ldap": {
            "service_field": "winlog.channel",
            "service_values": [
                "Microsoft-Windows-LDAP Client/Debug"
            ]
        },
        "lsa-server": {
            "service_field": "winlog.channel",
            "service_values": [
                "Microsoft-Windows-LSA/Operational"
            ]
        },
        "msexchange-management": {
            "service_field": "winlog.channel",
            "service_values": [
                "MSExchange Management"
            ]
        },
        "ntfs": {
            "service_field": "winlog.channel",
            "service_values": [
                "Microsoft-Windows-Ntfs/Operational"
            ]
        },
        "ntlm": {
            "service_field": "winlog.channel",
            "service_values": [
                "Microsoft-Windows-NTLM/Operational"
            ]
        },
        "openssh": {
            "service_field": "winlog.channel",
            "service_values": [
                "OpenSSH/Operational"
            ]
        },
        "powershell": {
            "service_field": "winlog.channel",
            "service_values": [
                "Microsoft-Windows-PowerShell/Operational"
            ]
        },
        "powershell-classic": {
            "service_field": "winlog.channel",
            "service_values": [
                "Windows PowerShell"
            ]
        },
        "printservice-admin": {
            "service_field": "winlog.channel",
            "service_values": [
                "Microsoft-Windows-PrintService/Admin"
            ]
        },
        "printservice-operational": {
            "service_field": "winlog.channel",
            "service_values": [
                "Microsoft-Windows-PrintService/Operational"
            ]
        },
        "security": {
            "service_field": "winlog.channel",
            "service_values": [
                "Security"
            ]
        },
        "security-mitigations": {
            "service_field": "winlog.channel",
            "service_values": [
                "Microsoft-Windows-Security-Mitigations/Kernel Mode",
                "Microsoft-Windows-Security-Mitigations/User Mode"
            ]
        },
        "sense": {
            "service_field": "winlog.channel",
            "service_values": [
                "Microsoft-Windows-SENSE/Operational"
            ]
        },
        "servicebus-client": {
            "service_field": "winlog.channel",
            "service_values": [
                "Microsoft-Windows-ServiceBus-Client/Operational",
                "Microsoft-Windows-ServiceBus-Client/Admin"
            ]
        },
        "shell-core": {
            "service_field": "winlog.channel",
            "service_values": [
                "Microsoft-Windows-Shell-Core/Operational"
            ]
        },
        "smbclient-security": {
            "service_field": "winlog.channel",
            "service_values": [
                "Microsoft-Windows-SmbClient/Security"
            ]
        },
        "sysmon": {
            "service_field": "winlog.channel",
            "service_values": [
                "Microsoft-Windows-Sysmon/Operational"
            ]
        },
        "system": {
            "service_field": "winlog.channel",
            "service_values": [
                "System"
            ]
        },
        "taskcheduler": {
            "service_field": "winlog.channel",
            "service_values": [
                "Microsoft-Windows-TaskScheduler/Operational"
            ]
        },
        "terminalservices-localsessionmanager": {
            "service_field": "winlog.channel",
            "service_values": [
                "Microsoft-Windows-TerminalServices-LocalSessionManager/Operational"
            ]
        },
        "vhdmp": {
            "service_field": "winlog.channel",
            "service_values": [
                "Microsoft-Windows-VHDMP/Operational"
            ]
        },
        "windefend": {
            "service_field": "winlog.channel",
            "service_values": [
                "Microsoft-Windows-Windows Defender"
            ]
        },
        "wmi": {
            "service_field": "winlog.channel",
            "service_values": [
                "Microsoft-Windows-WMI-Activity/Operational"
            ]
        }
    },
    "mappings": {
        "windows": {
            "allow_prefixed": true,
            "fields": {
                "AccountDomain": {
                    "ecs": [
                        "user.domain"
                    ]
                },
                "AccountName": {
                    "ecs": [
                        "user.name"
                    ]
                },
                "Application": {
                    "ecs": [
                        "process.executable"
                    ]
                },
                "Archived": {
                    "ecs": [
                        "sysmon.file.archived"
                    ]
                },
                "Channel": {
                    "ecs": [
                        "winlog.channel"
                    ]
                },
                "ClientAddress": {
                    "ecs": [
                        "source.ip"
                    ]
                },
                "ClientName": {
                    "ecs": [
                        "source.domain"
                    ]
                },
                "CommandLine": {
                    "ecs": [
                        "process.command_line",
                        "powershell.command.value"
                    ]
                },
                "CommandName": {
                    "ecs": [
                        "powershell.command.name"
                    ]
                },
                "CommandPath": {
                    "ecs": [
                        "powershell.command.path"
                    ]
                },
                "CommandType": {
                    "ecs": [
                        "powershell.command.type"
                    ]
                },
                "Company": {
                    "ecs": [
                        "process.pe.company",
                        "file.pe.company"
                    ]
                },
                "Computer": {
                    "ecs": [
                        "winlog.computer_name"
                    ]
                },
                "ComputerName": {
                    "ecs": [
                        "winlog.computer_name"
                    ]
                },
                "CurrentDirectory": {
                    "ecs": [
                        "process.working_directory"
                    ]
                },
                "Description": {
                    "ecs": [
                        "process.pe.description",
                        "file.pe.description",
                        "winlog.event_data.Description"
                    ]
                },
                "DestAddress": {
                    "ecs": [
                        "destination.ip"
                    ]
                },
                "DestPort": {
                    "ecs": [
                        "destination.port"
                    ]
                },
                "Destination": {
                    "ecs": [
                        "process.executable"
                    ]
                },
                "DestinationHostname": {
                    "ecs": [
                        "destination.domain"
                    ]
                },
                "DestinationIp": {
                    "ecs": [
                        "destination.ip"
                    ]
                },
                "DestinationPort": {
                    "ecs": [
                        "destination.port"
                    ]
                },
                "DestinationPortName": {
                    "ecs": [
                        "network.protocol"
                    ]
                },
                "Device": {
                    "ecs": [
                        "file.path"
                    ]
                },
                "Direction": {
                    "ecs": [
                        "network.direction"
                    ]
                },
                "EngineVersion": {
                    "ecs": [
                        "powershell.engine.version"
                    ]
                },
                "EventID": {
                    "ecs": [
                        "event.code"
                    ]
                },
                "EventRecordID": {
                    "ecs": [
                        "winlog.record_id"
                    ]
                },
                "ProcessID": {
                    "ecs": [
                        "process.pid"
                    ]
                },
                "ThreadID": {
                    "ecs": [
                        "process.thread.id"
                    ]
                },
                "FileName": {
                    "ecs": [
                        "file.path"
                    ]
                },
                "FileVersion": {
                    "ecs": [
                        "process.pe.file_version",
                        "file.pe.file_version"
                    ]
                },
                "HostApplication": {
                    "ecs": [
                        "process.command_line"
                    ]
                },
                "HostId": {
                    "ecs": [
                        "process.entity_id"
                    ]
                },
                "HostName": {
                    "ecs": [
                        "process.title"
                    ]
                },
                "HostVersion": {
                    "ecs": [
                        "powershell.process.executable_version"
                    ]
                },
                "Image": {
                    "ecs": [
                        "process.executable"
                    ]
                },
                "ImageLoaded": {
                    "ecs": [
                        "file.path"
                    ]
                },
                "Imphash": {
                    "ecs": [
                        "file.pe.imphash"
                    ]
                },
                "Inititated": {
                    "ecs": [
                        "network.direction"
                    ]
                },
                "IpAddress": {
                    "ecs": [
                        "source.ip"
                    ]
                },
                "IpPort": {
                    "ecs": [
                        "source.port"
                    ]
                },
                "IsExecutable": {
                    "ecs": [
                        "sysmon.file.is_executable"
                    ]
                },
                "MessageNumber": {
                    "ecs": [
                        "powershell.sequence"
                    ]
                },
                "MessageTotal": {
                    "ecs": [
                        "powershell.total"
                    ]
                },
                "NewEngineState": {
                    "ecs": [
                        "powershell.engine.new_state"
                    ]
                },
                "NewProcessId": {
                    "ecs": [
                        "process.pid"
                    ]
                },
                "NewProcessName": {
                    "ecs": [
                        "process.executable"
                    ]
                },
                "NewProviderState": {
                    "ecs": [
                        "powershell.provider.new_state"
                    ]
                },
                "OriginalFileName": {
                    "ecs": [
                        "process.pe.original_file_name",
                        "file.pe.original_file_name"
                    ]
                },
                "ParentCommandLine": {
                    "ecs": [
                        "process.parent.command_line"
                    ]
                },
                "ParentImage": {
                    "ecs": [
                        "process.parent.executable"
                    ]
                },
                "ParentProcessGuid": {
                    "ecs": [
                        "process.parent.entity_id"
                    ]
                },
                "ParentProcessId": {
                    "ecs": [
                        "process.parent.pid"
                    ]
                },
                "ParentProcessName": {
                    "ecs": [
                        "process.parent.name"
                    ]
                },
                "PipeName": {
                    "ecs": [
                        "file.name"
                    ]
                },
                "PipelineId": {
                    "ecs": [
                        "powershell.pipeline_id"
                    ]
                },
                "ProcessGuid": {
                    "ecs": [
                        "process.entity_id"
                    ]
                },
                "ProcessId": {
                    "ecs": [
                        "process.pid"
                    ]
                },
                "ProcessName": {
                    "ecs": [
                        "process.executable"
                    ]
                },
                "Product": {
                    "ecs": [
                        "process.pe.product",
                        "file.pe.product"
                    ]
                },
                "Protocol": {
                    "ecs": [
                        "network.transport"
                    ]
                },
                "Provider": {
                    "ecs": [
                        "event.provider"
                    ]
                },
                "ProviderName": {
                    "ecs": [
                        "powershell.provider.name"
                    ]
                },
                "Provider_Name": {
                    "ecs": [
                        "winlog.provider_name"
                    ]
                },
                "QueryName": {
                    "ecs": [
                        "dns.question.name"
                    ]
                },
                "QueryStatus": {
                    "ecs": [
                        "sysmon.dns.status"
                    ]
                },
                "RunspaceId": {
                    "ecs": [
                        "powershell.runspace_id"
                    ]
                },
                "ScriptBlockId": {
                    "ecs": [
                        "powershell.file.script_block_id"
                    ]
                },
                "ScriptBlockText": {
                    "ecs": [
                        "powershell.file.script_block_text"
                    ]
                },
                "ScriptName": {
                    "ecs": [
                        "file.path"
                    ]
                },
                "SequenceNumber": {
                    "ecs": [
                        "event.sequence"
                    ]
                },
                "ServiceName": {
                    "ecs": [
                        "service.name"
                    ]
                },
                "Signed": {
                    "ecs": [
                        "file.code_signature.signed"
                    ]
                },
                "Signature": {
                    "ecs": [
                        "file.code_signature.subject_name"
                    ]
                },
                "SignatureStatus": {
                    "ecs": [
                        "file.code_signature.status"
                    ]
                },
                "SourceAddress": {
                    "ecs": [
                        "source.ip"
                    ]
                },
                "SourceHostname": {
                    "ecs": [
                        "source.domain"
                    ]
                },
                "SourceImage": {
                    "ecs": [
                        "process.executable"
                    ]
                },
                "SourceIp": {
                    "ecs": [
                        "source.ip"
                    ]
                },
                "SourcePort": {
                    "ecs": [
                        "source.port"
                    ]
                },
                "SourceProcessGuid": {
                    "ecs": [
                        "process.entity_id"
                    ]
                },
                "SourceProcessId": {
                    "ecs": [
                        "process.pid"
                    ]
                },
                "SourceThreadId": {
                    "ecs": [
                        "process.thread.id"
                    ]
                },
                "SubjectDomainName": {
                    "ecs": [
                        "user.domain"
                    ]
                },
                "SubjectLogonId": {
                    "ecs": [
                        "winlog.logon.id"
                    ]
                },
                "SubjectUserName": {
                    "ecs": [
                        "user.name"
                    ]
                },
                "SubjectUserSid": {
                    "ecs": [
                        "user.id"
                    ]
                },
                "TargetDomainName": {
                    "ecs": [
                        "user.domain"
                    ]
                },
                "TargetFilename": {
                    "ecs": [
                        "file.path"
                    ]
                },
                "TargetLogonId": {
                    "ecs": [
                        "winlog.logon.id"
                    ]
                },
                "TargetObject": {
                    "ecs": [
                        "registry.path"
                    ]
                },
                "User": {
                    "ecs": [
                        "user.name"
                    ]
                },
                "WorkstationName": {
                    "ecs": [
                        "source.domain"
                    ]
                }
            }
        }
    }
}